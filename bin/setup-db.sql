drop table if exists link;
drop table if exists usr;
drop table if exists vote;

create table usr (
  id int generated by default as identity primary key,
  name text not null,
  email text not null,
  password text not null,
  created_at timestamp not null default current_timestamp,
  updated_at timestamp not null default current_timestamp);

insert into usr (name, email, password) values
  ('John', 'john@hotmail.com', 'bcrypt+sha512$28d97d37dee1b110225f9ed22c819b4d$12$cba2c9a398cebb64d032ff7cf1764614a06b3c01d3295d79'), -- john hashed via buddy/derive
  ('Paul', 'paul@gmail.com', 'bcrypt+sha512$8a5e1717e6092b755e52af298dbf0e1a$12$4eca6554ce87ab5b50ef41eaefe76659616a6c050d5c4be9');   -- paul hashed via buddy/derive

create table link (
  id int generated by default as identity primary key,
  description text,
  url text not null,
  usr_id int not null,
  created_at timestamp not null default current_timestamp,
  updated_at timestamp not null default current_timestamp);

insert into link (description, url, usr_id) values
  ('INIT - Prisma turns your database into a GraphQL API', 'https://www.prismagraphql.com', 1),
  ('INIT - The best GraphQL client', 'https://www.apollographql.com/docs/react/', 2);

create table vote (
  id int generated by default as identity primary key,
  link_id int not null,
  usr_id int not null,
  created_at timestamp not null default current_timestamp,
  updated_at timestamp not null default current_timestamp);

insert into vote (link_id, usr_id) values
  (1, 1),
  (1, 2),
  (2, 1);
